{% extends "base/base.html" %}
{% load static %}


{% block content %}
<main>
  <div class="page-header">
    <div class="container">
      <h1>Catalog Books</h1>
    </div>
  </div>

  <div class="container">
    <div class="catalog-layout">
      <aside class="filters">
        <h3>Filters</h3>
        <form method="get" action="#">
          <div class="filter-group">
            {{ form_filter }}
          </div>
          <button class="btn">Apply</button>
        </form>
      </aside>

      <div class="catalog-books">
        {% if user.is_authenticated and user.is_superuser %}
          <br>
          <a
              href="{% url 'library:book_create_view' %}"
              class="btn-secondary"
              style="background-color: #FFEE8C">Create Book
          </a>
          <a
              href="{% url 'library:genre_create_view' %}"
              class="btn-secondary"
              style="background-color: #FFEE8C">Create Genre
          </a>
          <a
              href="{% url 'library:author_create_view' %}"
              class="btn-secondary"
              style="background-color: #FFEE8C">Create Author
          </a>
          <br>
          <br>
        {% endif %}
        <div class="books-grid">
          {% if messages %}
            <ul class="messages">
              {% for message in messages %}
                <li class="{{ message.tags }}">
                  {{ message }}
                </li>
              {% endfor %}
            </ul>
          {% endif %}
          {% for book in books %}
            <div class="book-card">
              {% if book.cover_image_url %}
                <img src="{{ book.cover_image_url.url }}" alt="{{ book.title }}">
              {% else %}
                <img src="{% static 'assets/pics/44014ddd859a3d1efa1d9e22abd33c36.jpg' %}" alt="No image">
              {% endif %}
              <h3 style="word-break: break-all;">{{ book.title|wordwrap:15 }}</h3>
              <h3>{{ book.price }}</h3>
              <h3>{{ book.quantity }}</h3>
              <h3>{{ book.publication_year }}</h3>
              <p>{{ book.author.all|join:", " }}</p>
              <p style="word-break: break-all;">{{ book.description|truncatechars:200 }}</p>
              <form method="post" action="{% url 'library:add_to_cart_item' book.pk %}">
                {% csrf_token %}

                <button type="submit" class="btn-secondary">Add</button>
              </form>
              <br>
              <a href="{% url 'library:book_page_view' book.pk %}" class="btn-secondary">Details</a>
              {% if user.is_authenticated and user.is_superuser %}
                <br>
                <a
                    href="{% url 'library:book_update_view' book.pk %}"
                    class="btn-secondary"
                    style="background-color: #FFDBBB">Editing
                </a>
                <br>
                <a
                    href="{% url 'library:book_delete_view' book.pk %}"
                    class="btn-secondary"
                    style="background-color: #FFB09C">Delete
                </a>
              {% endif %}
            </div>
          {% endfor %}
        </div>
      </div>
    </div>
    {% block pagination %}
      {% include "includes/pagination/pagination.html" %}
    {% endblock %}
  </div>
</main>
{% endblock %}